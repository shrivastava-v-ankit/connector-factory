<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="2" time="1.207" timestamp="2024-07-03T15:50:10.554810" hostname="PSL-5CD201FG41"><testcase classname="test.connector_factory_test" name="test_database_factory" time="0.223"><failure message="AttributeError: 'Engine' object has no attribute 'cursor'">def test_database_factory():
    
        temp_dir = tempfile.gettempdir()
    
        db_file = os.path.join(temp_dir, "test_db.db")
    
        os.remove(db_file) if os.path.exists(db_file) else None
        config = {
            "database": "test_db",
            "path": temp_dir
        }
    
        db = ConnectorFactory(connector_type="sqlite", config=config)
        db.create_session()
    
        db.execute_sql(sql="create table test (id int PRIMARY KEY)")
        db.execute_sql(sql="insert into test values (1)")
        db.execute_sql(sql="insert into test values (2)")
    
        assert os.path.exists(db_file) == 1
    
        rows = db.execute_sql(sql="select * from test")
        assert rows == [(1,), (2,)]
    
&gt;       df = db.get_df(sql="select * from test")

test/connector_factory_test.py:34: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
connector_factory/factory.py:302: in get_df
    return self.connection.get_df(sql=sql, chunk_size=chunk_size)
connector_factory/decorator.py:227: in get_df
    df = pandas.read_sql(sql=sql,
venv3.12/lib/python3.12/site-packages/pandas/io/sql.py:706: in read_sql
    return pandas_sql.read_query(
venv3.12/lib/python3.12/site-packages/pandas/io/sql.py:2738: in read_query
    cursor = self.execute(sql, params)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;pandas.io.sql.SQLiteDatabase object at 0x7efa6e773bf0&gt;, sql = 'select * from test', params = None

    def execute(self, sql: str | Select | TextClause, params=None):
        if not isinstance(sql, str):
            raise TypeError("Query must be a string unless using sqlalchemy.")
        args = [] if params is None else [params]
&gt;       cur = self.con.cursor()
E       AttributeError: 'Engine' object has no attribute 'cursor'

venv3.12/lib/python3.12/site-packages/pandas/io/sql.py:2672: AttributeError</failure></testcase><testcase classname="test.connector_factory_test" name="test_error_database_factory" time="0.022" /></testsuite></testsuites>